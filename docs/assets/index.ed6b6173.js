var u=Object.defineProperty;var d=(o,e,t)=>e in o?u(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>(d(o,typeof e!="symbol"?e+"":e,t),t);import{P as n}from"./vendor.c2cc9365.js";const p=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const h of i.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}};p();class g extends n.Renderer.WebGL.Pipelines.MultiPipeline{constructor(e){super({game:e,fragShader:`
      precision mediump float;

      uniform sampler2D uMainSampler[%count%];
      uniform vec2 uResolution;
      uniform float uTime;

      varying vec2 outTexCoord;
      varying float outTexId;
      varying vec4 outTint;

      vec4 plasma()
      {
          vec2 pixelPos = gl_FragCoord.xy / uResolution * 20.0;
          float freq = 0.8;
          float value =
              sin(uTime + pixelPos.x * freq) +
              sin(uTime + pixelPos.y * freq) +
              sin(uTime + (pixelPos.x + pixelPos.y) * freq) +
              cos(uTime + sqrt(length(pixelPos - 0.5)) * freq * 2.0);

          return vec4(
              cos(value),
              sin(value),
              sin(value * 3.14 * 2.0),
              cos(value)
          );
      }

      void main(){
        vec4 texture;

        %forloop%

        texture *= vec4(outTint.rgb * outTint.a, outTint.a);

        gl_FragColor = texture * plasma();
    }`,uniforms:["uProjectionMatrix","uViewMatrix","uModelMatrix","uMainSampler","uResolution","uTime"]})}}var y={type:n.WEBGL,parent:"game",backgroundColor:"#33A5E7",scale:{width:96*2,height:160*2,mode:n.Scale.FIT,autoCenter:n.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},fps:10,antialias:!1,render:{pixelArt:!0},pipeline:{CustomPipeline:g}};const S={path:"assets/img/chana_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},x={path:"assets/img/masara_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},v={path:"assets/img/makiko_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30}},b={path:"assets/img/makoto_ss.png",scale:1,frameW:64,frameH:64,frameStart:0,frameEnd:3,bodySize:{w:40,h:60}},C={path:"assets/img/rancia_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30}},k={path:"assets/img/taki_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},w={path:"assets/img/tanikou_kari.png",scale:2,frameW:28,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},_={path:"assets/img/konataro_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30}},T={path:"assets/img/watari_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},E={path:"assets/img/chachamaru_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},W={path:"assets/img/dairi_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},H={path:"assets/img/erishia_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}},z={path:"assets/img/taguchi_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30}};var m={chana:S,masara:x,makiko:v,makoto:b,rancia:C,taki:k,tanikou:w,konataro:_,watari:T,chachamaru:E,dairi:W,erishia:H,taguchi:z};class M extends n.Physics.Arcade.Sprite{constructor(e,t,s,a){super(e,t,s,a);r(this,"charaTween");r(this,"isMove");r(this,"name");r(this,"move_anime");r(this,"idle_anime");return e.add.existing(this),e.physics.add.existing(this),this.isMove=!1,this.name=a,this.changeChara(a),this.setAnime(a,m[a].frameStart,m[a].frameEnd),this.setInteractive(),this.setOrigin(.5,.9),this.on("pointerup",i=>{console.log(this.name)}),this}move(e,t,s){this.charaTween&&(this.charaTween.stop(),this.charaTween.remove()),this.isMove=!0;let a=!1;const i={x:e,y:t};this.x<i.x&&(a=!0),this.flipX=a,this.charaTween=this.scene.tweens.add({targets:this,props:{x:{value:i.x,duration:Math.abs(i.x-this.x)*20},y:{value:i.y,duration:Math.abs(i.y-this.y)*20}},ease:"Sine.easeInOut",callbackScope:this,onComplete:()=>{this.anims.stop(),this.isMove=!1,this.setFrame(0),s&&s()}})}changeChara(e){this.name=e,this.setTexture(e),this.setScale(m[e].scale),this.body.setSize(m[e].bodySize.w,m[e].bodySize.h),this.setAnime(e,m[e].frameStart,m[e].frameEnd)}evolution(e){this.anims.pause(),this.move(96,160,async()=>{this.scene.tweens.addCounter({from:255,to:0,duration:2e3,onUpdate:t=>{const s=Math.floor(t.getValue());this.setTint(n.Display.Color.GetColor(s,s,s))},onComplete:()=>{this.scene.tweens.addCounter({from:0,to:255,duration:3e3,onUpdate:t=>{const s=Math.floor(t.getValue());this.setTintFill(n.Display.Color.GetColor(s,s,s/1.2))},onComplete:()=>{const t=this.name;let s=1e4,a=1.12;this.scene.tweens.addCounter({from:1e4,to:0,duration:1e4,onUpdate:i=>{i.getValue()<=s&&(this.name==t?this.changeChara(e):this.changeChara(t),s=s/a)},onComplete:()=>{this.name=="chana"?this.changeChara("masara"):this.name=="masara"?this.changeChara(n.Utils.Array.GetRandom(["makiko","rancia"])):this.changeChara(n.Utils.Array.GetRandom(Object.keys(m))),this.clearTint()}})}})}})})}setAnime(e=this.name,t=0,s=3){this.move_anime=this.scene.anims.create({key:e+"_move",frames:this.anims.generateFrameNumbers(e,{start:t,end:s}),frameRate:10}),this.idle_anime=this.scene.anims.create({key:e+"_idle",frames:this.anims.generateFrameNumbers(e,{start:0,end:1}),frameRate:2,repeat:-1})}preUpdate(e,t){super.preUpdate(e,t),this.isMove?this.anims.play(this.name+"_move",!0):this.anims.play(this.name+"_idle",!0)}}class P extends n.Scene{constructor(){super("GameScene");r(this,"isAnime");r(this,"charaTween");r(this,"player");r(this,"charaName");this.isAnime=!1,this.charaName="chana"}preload(){this.load.image("sky","assets/img/sky.png"),this.load.image("ground","assets/img/ground.png");for(const e in m)if(Object.prototype.hasOwnProperty.call(m,e)){const t=m[e];this.load.spritesheet(e,t.path,{frameWidth:t.frameW,frameHeight:t.frameH})}}create(){const t=this.scale.width/2,s=this.scale.height,a=s/2,i=this.add.image(t,a,"sky"),h=this.add.image(t,s-32,"ground");i.scale=2,h.scale=2,this.player=new M(this,32,100,this.charaName),this.player.setCollideWorldBounds(!0),i.setInteractive(),i.on("pointerup",c=>{var f;(f=this.player)==null||f.move(c.upX,c.upY)},this)}update(){}}class l extends n.GameObjects.Container{constructor(e,t,s,a){super(e,t,s);r(this,"seKey","");r(this,"text");r(this,"sprite");r(this,"frame");r(this,"fill",0);r(this,"stroke",16777215);const{color:i,text:h="",onClick:c}=a;this.scene=e,this.scene.add.existing(this),this.sprite=e.add.sprite(0,0,"btn",1),this.setSize(60,36).setInteractive(),this.sprite.setTint(i),this.sprite.setScale(2),this.frame=e.add.sprite(0,0,"btn_frame",1),this.frame.setScale(2),this.text=e.add.text(0,0,h,{fontSize:"12px",align:"center",color:"#ffffff",fontFamily:"misaki"}),this.text.setAlpha(.9),this.text.setOrigin(.5,.9),this.add([this.sprite,this.frame,this.text]),this.setAnime(),this.on("pointerup",f=>{c&&c(f),this.sprite.anims.play("btn",!0),this.frame.anims.play("btn_frame",!0)})}setSeKey(e){return this.seKey=e,this}setText(e){return this.text.setText(e),this}setAnime(){this.scene.anims.create({key:"btn",frames:this.sprite.anims.generateFrameNumbers("btn",{frames:[1,0,1]}),frameRate:15}),this.scene.anims.create({key:"btn_frame",frames:this.frame.anims.generateFrameNumbers("btn_frame",{frames:[1,0,1]}),frameRate:15})}}class A extends n.Scene{constructor(){super("UIScene");r(this,"game");n.Scene.call(this,{key:"UIScene",active:!0})}preload(){this.load.spritesheet("btn","assets/img/btn_gray2.png",{frameWidth:30,frameHeight:18}),this.load.spritesheet("btn_frame","assets/img/btn_gray_frame.png",{frameWidth:30,frameHeight:18})}create(){this.game=this.scene.get("GameScene"),new l(this,32,300,{color:16711680,text:"\u3054\u306F\u3093",onClick:()=>{console.log("gohan")}}),new l(this,96,300,{color:16776960,text:"\u3046\u3093\u3069\u3046",onClick:()=>{console.log("undou")}}),new l(this,160,300,{color:39423,text:"\u30C8\u30A4\u30EC",onClick:()=>{console.log("toire")}}),new l(this,32,20,{text:"\u3057\u3093\u304B",onClick:()=>{var e;console.log("shinka"),(e=this.game.player)==null||e.evolution("taki")}}),new l(this,160,20,{text:"\u30EA\u30BB\u30C3\u30C8",onClick:()=>{var e;console.log("reset"),(e=this.game.player)==null||e.changeChara("chana")}})}}new n.Game(Object.assign(y,{scene:[P,A]}));
