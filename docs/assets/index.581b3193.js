var c=Object.defineProperty;var u=(n,e,t)=>e in n?c(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var a=(n,e,t)=>(u(n,typeof e!="symbol"?e+"":e,t),t);import{P as Phaser,p as phaser}from"./vendor.207b395b.js";const p=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}};p();class CustomPipeline extends Phaser.Renderer.WebGL.Pipelines.MultiPipeline{constructor(e){super({game:e,fragShader:`
      precision mediump float;

      uniform sampler2D uMainSampler[%count%];
      uniform vec2 uResolution;
      uniform float uTime;

      varying vec2 outTexCoord;
      varying float outTexId;
      varying vec4 outTint;

      vec4 plasma()
      {
          vec2 pixelPos = gl_FragCoord.xy / uResolution * 20.0;
          float freq = 0.8;
          float value =
              sin(uTime + pixelPos.x * freq) +
              sin(uTime + pixelPos.y * freq) +
              sin(uTime + (pixelPos.x + pixelPos.y) * freq) +
              cos(uTime + sqrt(length(pixelPos - 0.5)) * freq * 2.0);

          return vec4(
              cos(value),
              sin(value),
              sin(value * 3.14 * 2.0),
              cos(value)
          );
      }

      void main(){
        vec4 texture;

        %forloop%

        texture *= vec4(outTint.rgb * outTint.a, outTint.a);

        gl_FragColor = texture * plasma();
    }`,uniforms:["uProjectionMatrix","uViewMatrix","uModelMatrix","uMainSampler","uResolution","uTime"]})}}var config={type:Phaser.WEBGL,parent:"game",backgroundColor:"#33A5E7",scale:{width:96*2,height:160*2,mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"arcade",arcade:{gravity:{x:0,y:0}}},fps:10,antialias:!1,render:{pixelArt:!0},pipeline:{CustomPipeline}};const chara_setting={tamago:{path:"assets/img/chara/tamago.png",scale:1,frameW:32,frameH:32,frameStart:0,frameEnd:0,bodySize:{w:40,h:60},move:!1},chana:{path:"assets/img/chara/chana_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:20},move:!0},masara:{path:"assets/img/chara/masara_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},makiko:{path:"assets/img/chara/makiko_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30},move:!0},makoto:{path:"assets/img/chara/makoto_ss.png",scale:1,frameW:64,frameH:64,frameStart:0,frameEnd:3,bodySize:{w:40,h:60},move:!0},rancia:{path:"assets/img/chara/rancia_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30},move:!0},taki:{path:"assets/img/chara/taki_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},tanikou:{path:"assets/img/chara/tanikou_kari.png",scale:2,frameW:28,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},konataro:{path:"assets/img/chara/konataro_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:1,bodySize:{w:20,h:30},move:!0},watari:{path:"assets/img/chara/watari_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},chachamaru:{path:"assets/img/chara/chachamaru_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},dairi:{path:"assets/img/chara/dairi_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},erishia:{path:"assets/img/chara/erishia_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},taguchi:{path:"assets/img/chara/taguchi_ss.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:3,bodySize:{w:20,h:30},move:!0},haka:{path:"assets/img/chara/haka.png",scale:2,frameW:32,frameH:32,frameStart:0,frameEnd:0,bodySize:{w:20,h:30},move:!1}};class Character extends Phaser.GameObjects.Container{constructor(e,t,s,i){super(e,t,s);a(this,"sprite");a(this,"charaTween");a(this,"isMove");a(this,"isEvolution");a(this,"name");a(this,"move_anime");a(this,"idle_anime");a(this,"sprite");a(this,"state_sprite");return this.scene=e,this.isMove=!1,this.isEvolution=!1,this.name=i,this.sprite=this.scene.add.sprite(0,0,this.name),this.state_sprite=this.scene.add.sprite(0,0,"haraheri"),this.state_sprite.setScale(2),this.state_sprite.setVisible(!1),this.add([this.sprite,this.state_sprite]),this.scene.physics.add.existing(this.sprite),this.scene.add.existing(this),this.changeChara(i),this.setAnime(i,chara_setting[i].frameStart,chara_setting[i].frameEnd),this.sprite.on("pointerup",r=>{console.log(this.name)}),this}move(e,t,s){if(!chara_setting[this.name].move){s&&s();return}this.charaTween&&(this.charaTween.stop(),this.charaTween.remove()),this.isMove=!0;let i=!1;const r={x:e,y:t};this.x<r.x&&(i=!0),this.sprite.flipX=i,this.charaTween=this.scene.tweens.add({targets:this,props:{x:{value:r.x,duration:Math.abs(r.x-this.x)*20},y:{value:r.y,duration:Math.abs(r.y-this.y)*20}},ease:"Sine.easeInOut",callbackScope:this,onComplete:()=>{this.sprite.anims.stop(),this.isMove=!1,this.sprite.setFrame(0),s&&s()}})}changeChara(e){this.name=e,this.sprite.setTexture(e),this.sprite.setScale(chara_setting[e].scale),this.sprite.body.setSize(chara_setting[e].bodySize.w,chara_setting[e].bodySize.h),this.setAnime(e,chara_setting[e].frameStart,chara_setting[e].frameEnd),this.state_sprite.setPosition(chara_setting[e].bodySize.w*chara_setting[e].scale,-chara_setting[e].bodySize.h)}evolution(e){this.isEvolution||(this.isEvolution=!0,this.scene.save_data.data.player.stage++,this.scene.save_data.data.player.chara=e,this.scene.save(),this.state_sprite.setVisible(!1),this.sprite.anims.pause(),this.move(this.scene.wCenter,this.scene.sceneH-100,async()=>{this.scene.tweens.addCounter({from:255,to:0,duration:2e3,onUpdate:t=>{const s=Math.floor(t.getValue());this.sprite.setTint(Phaser.Display.Color.GetColor(s,s,s))},onComplete:()=>{if(e=="haka"){this.changeChara(e),this.sprite.clearTint(),this.isEvolution=!1;return}this.scene.tweens.addCounter({from:0,to:255,duration:3e3,onUpdate:t=>{const s=Math.floor(t.getValue());this.sprite.setTintFill(Phaser.Display.Color.GetColor(s,s,s/1.2))},onComplete:()=>{const t=this.name;let s=1e4,i=1.1;this.scene.tweens.addCounter({from:1e4,to:0,duration:1e4,onUpdate:r=>{r.getValue()<=s&&(this.name==t?this.changeChara(e):this.changeChara(t),s=s/i)},onComplete:()=>{this.changeChara(e),this.sprite.clearTint(),this.isEvolution=!1}})}})}})}))}changeStatus(e){if(["tamago","haka"].indexOf(this.name)!=-1){this.state_sprite.setTexture("hutsuu"),this.state_sprite.setVisible(!1),this.scene.save_data.data.player.status=e,this.scene.save();return}this.scene.save_data.data.player.status=e,this.scene.save(),e=="hutsuu"?this.state_sprite.setVisible(!1):(this.state_sprite.setTexture(e),this.isEvolution==!1&&this.state_sprite.setVisible(!0))}setAnime(e=this.name,t=0,s=3){this.move_anime=this.scene.anims.create({key:e+"_move",frames:this.sprite.anims.generateFrameNumbers(e,{start:t,end:s}),frameRate:10}),this.idle_anime=this.scene.anims.create({key:e+"_idle",frames:this.sprite.anims.generateFrameNumbers(e,{start:0,end:1}),frameRate:2,repeat:-1})}preUpdate(e,t){this.isMove?this.sprite.anims.play(this.name+"_move",!0):this.sprite.anims.play(this.name+"_idle",!0)}}const foods_setting=[{text:"\u308A\u3093\u3054",name:"ringo",images:[{image_name:"ringo",path:"assets/img/foods/ringo.png"}],effect:[{target:"health",operation:"+",value:1}]},{text:"\u304A\u3093\u306A",name:"girl",images:[{image_name:"girl",path:"assets/img/foods/girl.png"}],effect:[{target:"eros",operation:"+",value:2},{target:"intelligence",operation:"-",value:1},{target:"music",operation:"-",value:1}]},{text:"\u304D\u3087\u3046\u304B\u3057\u3087",name:"kyoukasyo",images:[{image_name:"kyoukasyo",path:"assets/img/foods/kyoukasyo.png"}],effect:[{target:"intelligence",operation:"+",value:2},{target:"eros",operation:"-",value:1},{target:"gag",operation:"-",value:1}]},{text:"\u30B3\u30FC\u30E9",name:"cola",images:[{image_name:"apple",path:"assets/img/foods/cola.png"}],effect:[{target:"health",operation:"-",value:2},{target:"cola",operation:"+",value:1}]},{text:"\uFF23\uFF24",name:"cd",images:[{image_name:"cd_0",path:"assets/img/foods/cd_0.png"},{image_name:"cd_1",path:"assets/img/foods/cd_1.png"},{image_name:"cd_2",path:"assets/img/foods/cd_2.png"},{image_name:"cd_3",path:"assets/img/foods/cd_3.png"},{image_name:"cd_4",path:"assets/img/foods/cd_4.png"},{image_name:"cd_5",path:"assets/img/foods/cd_5.png"}],effect:[{target:"music",operation:"+",value:2},{target:"gag",operation:"-",value:1},{target:"health",operation:"-",value:1}]},{text:"\u30C6\u30EC\u30D3",name:"tv",images:[{image_name:"tv",path:"assets/img/foods/tv.png"}],effect:[{target:"gag",operation:"+",value:2},{target:"intelligence",operation:"-",value:1},{target:"eros",operation:"-",value:1}]},{text:"\u304F\u3059\u308A",name:"kusuri",images:[{image_name:"kusuri",path:"assets/img/foods/kusuri.png"}],effect:[{target:"health",operation:"+",value:10},{target:"kusuri",operation:"+",value:1}]}],status_setting={genki:{image:{name:"genki",image_path:"assets/img/status/genki.png"}},haraheri:{image:{name:"haraheri",image_path:"assets/img/status/haraheri.png"}},dokuro:{image:{name:"dokuro",image_path:"assets/img/status/dokuro.png"}},heart:{image:{name:"heart",image_path:"assets/img/status/heart.png"}}},save_data_template={format_virsion:"0.0.1",data:{player:{chara:"tamago",stage:0,status:"hutsuu",parameter:{health:25,intelligence:0,music:0,eros:0,gag:0,cola:0,kusuri:0}},time:{start:null,last_evolution:null,last_meal:null},unko:[]}};class TimeManage{constructor(e){a(this,"scene");this.scene=e}getTimeDiff(e,t){const s=t-e;return Math.floor(s/6e4)}}class EvolutionManage{constructor(e){a(this,"scene");a(this,"player_data");this.scene=e}check(e){let t="";const s=this.getMaxParamKey();if(e>=0&&this.scene.save_data.data.player.stage==0&&(t="chana"),e>=60&&this.scene.save_data.data.player.stage==1&&(t="masara"),e>=840&&this.scene.save_data.data.player.stage==2&&(["music","gag"].indexOf(s)>=0&&(t="rancia"),["intelligence","eros"].indexOf(s)>=0&&(t="makiko")),e>=1440&&this.scene.save_data.data.player.stage==3){if(this.scene.save_data.data.player.parameter[s]<=25)return t="taki",t;if(this.scene.save_data.data.player.parameter.kusuri>=100)return t="konataro",t;if(this.scene.save_data.data.player.parameter.cola>=100)return t="watari",t;if(this.scene.save_data.data.player.parameter.music>=30||this.scene.save_data.data.player.parameter.health<=10)return t="makoto",t;if(this.scene.save_data.data.player.chara=="rancia"){if(s=="intelligence")return t="tanikou",t;if(s=="music")return t="makoto",t;if(s=="eros")return t="chachamaru",t;if(s=="gag")return t="watari",t}if(this.scene.save_data.data.player.chara=="makiko"){if(s=="intelligence")return t="taguchi",t;if(s=="music")return t="erishia",t;if(s=="eros")return t="dairi",t;if(s=="gag")return t="konataro",t}}return e>=2880&&this.scene.save_data.data.player.stage==4&&(t="haka"),t}getMaxParamKey(){let e="";for(const t in this.scene.save_data.data.player.parameter)["intelligence","music","eros","gag"].indexOf(t)>=0&&(e==""||this.scene.save_data.data.player.parameter[e]<this.scene.save_data.data.player.parameter[t])&&(e=t);return e}}class Unko extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s);a(this,"scene");a(this,"sprite");a(this,"onColide",()=>{});this.scene=e,this.sprite=e.add.sprite(0,0,"unko"),this.width=this.sprite.width,this.height=this.sprite.height,this.setDepth(1),this.add([this.sprite]),this.scene.add.existing(this),this.scene.physics.add.existing(this)}}class Game extends Phaser.Scene{constructor(){super("GameScene");a(this,"isAnime");a(this,"charaTween");a(this,"player");a(this,"charaName");a(this,"sceneW");a(this,"wCenter");a(this,"sceneH");a(this,"hCenter");a(this,"save_data");a(this,"food_group");a(this,"unko_group");a(this,"tm");a(this,"em");a(this,"onBlur",()=>{this.save()});a(this,"onFocus",()=>{});a(this,"tic",()=>{var s;this.checkUnko(),this.checkStatus();const e=this.tm.getTimeDiff(this.save_data.data.time.start,Date.now()),t=this.em.check(e);t!=""&&((s=this.player)==null||s.evolution(t))});a(this,"merge",(e,t)=>{let s=JSON.parse(JSON.stringify(e));for(let i in t)t.hasOwnProperty(i)&&(s[i]=i in e&&typeof s[i]=="object"&&typeof t[i]=="object"?this.merge(s[i],t[i]):t[i]);return s});this.sceneW=0,this.wCenter=0,this.sceneH=0,this.hCenter=0,this.save_data=JSON.parse(localStorage.getItem("save_data")),this.save_data?this.save_data.format_virsion!=save_data_template.format_virsion&&(this.save_data=this.merge(save_data_template,this.save_data),this.save_data.format_virsion=save_data_template.format_virsion,this.save()):this.save_data=save_data_template,this.isAnime=!1,this.charaName=this.save_data.data.player.chara,this.tm=new TimeManage(this),this.em=new EvolutionManage(this),this.food_group=[],this.unko_group=[]}preload(){this.load.image("kusamura","assets/img/bg/kusamura.png"),this.load.image("machi","assets/img/bg/machi.png"),this.load.image("umi","assets/img/bg/umi.png"),this.load.image("unko","assets/img/stuff/unko.png"),this.load.image("ryusui","assets/img/stuff/ryusui.png");for(const e in chara_setting)if(Object.prototype.hasOwnProperty.call(chara_setting,e)){const t=chara_setting[e];this.load.spritesheet(e,t.path,{frameWidth:t.frameW,frameHeight:t.frameH})}for(const e in foods_setting)if(Object.prototype.hasOwnProperty.call(foods_setting,e)){const t=foods_setting[e];for(let s=0;s<t.images.length;s++)this.load.image(t.images[s].image_name,t.images[s].path)}for(const e in status_setting)if(Object.prototype.hasOwnProperty.call(status_setting,e)){const t=status_setting[e];this.load.image(t.image.name,t.image.image_path)}}create(){this.save_data.data.time.start||(this.save_data.data.time.start=Date.now()),this.time.addEvent({delay:1e3,loop:!0,callback:this.tic}),this.sceneW=this.scale.width,this.wCenter=this.sceneW/2,this.sceneH=this.scale.height,this.hCenter=this.sceneH/2;const e=Phaser.Utils.Array.GetRandom(["kusamura","machi","umi"]),t=this.add.image(this.wCenter,this.hCenter,e),s=this.add.rectangle(0,this.hCenter-32,this.sceneW,this.hCenter);t.scale=2,s.setDisplayOrigin(),this.player=new Character(this,this.wCenter,this.sceneH-100,this.charaName),this.player.setDepth(99),s.setInteractive(),s.setOrigin(0,0),s.on("pointerup",r=>{var o,h;((o=this.player)==null?void 0:o.isEvolution)||(h=this.player)==null||h.move(r.upX,r.upY)},this),this.game.events.addListener(Phaser.Core.Events.BLUR,this.onBlur),this.game.events.addListener(Phaser.Core.Events.FOCUS,this.onFocus);const i=this.save_data.data.unko.concat();for(const r of i)this.unko_group.push(new Unko(this,r.x,r.y))}update(){}save(){localStorage.setItem("save_data",JSON.stringify(this.save_data))}checkUnko(){if(this.save_data.data.time.last_meal){const e=this.tm.getTimeDiff(this.save_data.data.time.last_meal,Date.now());if(this.save_data.data.unko.length<Math.floor(e/10)){const t=Math.floor(e/10)-this.save_data.data.unko.length;for(let s=0;s<t&&e<=1e3;s++){let i=Phaser.Math.Between(20,172),r=Phaser.Math.Between(150,250);this.unko_group.push(new Unko(this,i,r));const o={time:Date.now(),x:i,y:r};this.save_data.data.unko.push(o)}}}}checkStatus(){var t,s,i;if(this.save_data.data.player.parameter.health<=10){(t=this.player)==null||t.changeStatus("dokuro");return}if(this.tm.getTimeDiff(this.save_data.data.time.last_meal,Date.now())>=60){(s=this.player)==null||s.changeStatus("haraheri");return}(i=this.player)==null||i.changeStatus("hutsuu")}}class Button extends Phaser.GameObjects.Container{constructor(e,t,s,i){super(e,t,s);a(this,"seKey","");a(this,"text");a(this,"sprite");a(this,"frame");a(this,"fill",0);a(this,"stroke",16777215);const{color:r,text:o="",onClick:h}=i;this.scene=e,this.scene.add.existing(this),this.sprite=e.add.sprite(0,0,"btn",1),this.setSize(60,36).setInteractive(),this.sprite.setTint(r),this.sprite.setScale(2),this.frame=e.add.sprite(0,0,"btn_frame",1),this.frame.setScale(2),this.text=e.add.text(0,0,o,{fontSize:"12px",align:"center",color:"#ffffff",fontFamily:"misaki"}),this.text.setAlpha(.9),this.text.setOrigin(.5,.9),this.add([this.sprite,this.frame,this.text]),this.setAnime(),this.on("pointerup",m=>{h&&h(m),this.sprite.anims.play("btn",!0),this.frame.anims.play("btn_frame",!0)})}setSeKey(e){return this.seKey=e,this}setText(e){return this.text.setText(e),this}setAnime(){this.scene.anims.create({key:"btn",frames:this.sprite.anims.generateFrameNumbers("btn",{frames:[1,0,1]}),frameRate:15}),this.scene.anims.create({key:"btn_frame",frames:this.frame.anims.generateFrameNumbers("btn_frame",{frames:[1,0,1]}),frameRate:15})}}class Menu extends Phaser.GameObjects.Container{constructor(e,t,s,i){super(e,t,s);a(this,"buttons");a(this,"items");a(this,"itemsPerRow");this.scene=e,this.scene.add.existing(this),this.visible=!1,this.items=[],this.buttons=[],this.itemsPerRow=i}initMenu(){for(let s=0;s<this.items.length;s++){const i=this.scene.add.text(20+s%this.itemsPerRow*100,20+Math.floor(s/this.itemsPerRow)*30,this.items[s].text,{font:"12px misaki",color:"#ffffff"});i.alpha=1,i.setInteractive(),i.on("pointerup",()=>{this.onClick(s)}),this.buttons[s]=i}const e=this.scene.add.text(20+this.items.length%this.itemsPerRow*100,20+Math.floor(this.items.length/this.itemsPerRow)*30,"\u3068\u3058\u308B",{font:"12px misaki",color:"#ffffff"});e.alpha=1,e.setInteractive(),e.on("pointerup",()=>{this.setVisible(!1)});const t=this.scene.add.rectangle(0,0,this.scene.scale.width,this.items.length/this.itemsPerRow*30+40,0,.5);t.setOrigin(0,0),t.setInteractive(),this.add(t),this.buttons.push(e),this.add(this.buttons)}onClick(e){console.log(this.items[e]),this.setVisible(!1)}}const parameter_setting={health:{initial:25,max:50,min:0,text:"\u3051\u3093\u3053\u3046",description:""},intelligence:{initial:0,max:50,min:0,text:"\u3061\u306E\u3046",description:""},music:{initial:0,max:50,min:0,text:"\u304A\u3093\u304C\u304F",description:""},eros:{initial:0,max:50,min:0,text:"\u30A8\u30ED",description:""},gag:{initial:0,max:50,min:0,text:"\u30AE\u30E3\u30B0",description:""},cola:{initial:0,max:999,min:0,text:"\u30B3\u30FC\u30E9",description:""},kusuri:{initial:0,max:999,min:0,text:"\u304F\u3059\u308A",description:""}};class Food extends Phaser.GameObjects.Container{constructor(n,e,t,s){super(n,e,-20);a(this,"sprite");a(this,"foodTween");a(this,"food_data");a(this,"onColide",(obj1,obj2)=>{this.food_data.effect.forEach(effect=>{const pram_val=eval(this.scene.save_data.data.player.parameter[effect.target]+effect.operation+effect.value);effect.operation=="+"&&parameter_setting[effect.target].max>=pram_val&&(this.scene.save_data.data.player.parameter[effect.target]=pram_val),effect.operation=="-"&&parameter_setting[effect.target].min<=pram_val&&(this.scene.save_data.data.player.parameter[effect.target]=pram_val)}),this.scene.save_data.data.time.last_meal=Date.now(),this.destroy()});this.scene=n,this.food_data=foods_setting[s];const i=Phaser.Utils.Array.GetRandom(this.food_data.images);this.sprite=n.add.sprite(0,0,i.image_name),this.width=this.sprite.width,this.height=this.sprite.height,this.add([this.sprite]),this.scene.add.existing(this),this.setDepth(2);const r=new phaser.exports.Math.RandomDataGenerator,o=r.between(20,172),h=r.between(150,250);this.setX(o),this.fall(o,h)}fall(n,e,t){const s={x:n,y:e};this.foodTween=this.scene.tweens.add({targets:this,props:{y:{value:s.y,duration:1500}},ease:"Sine.easeIn",callbackScope:this,onComplete:()=>{this.scene.physics.add.existing(this),this.scene.physics.add.collider(this.scene.player.sprite,this,this.onColide)}})}}class FoodsMenu extends Menu{constructor(e,t,s,i,r){super(e,s,i,2);a(this,"game");this.scene=e,this.scene.add.existing(this),this.visible=!1,this.items=foods_setting,this.game=t,this.buttons=[],this.itemsPerRow=r,this.initMenu()}onClick(e){this.game.food_group.push(new Food(this.game,60,60,e))}}class Toilet extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s);a(this,"scene");a(this,"sprites");a(this,"toiletTween");a(this,"onColide",e=>{e.destroy()});this.scene=e,this.sprites=[];const i=this.scene.textures.get("ryusui"),r=13;for(let o=0;o<r;o++){let h=this.scene.add.sprite(0,i.source[0].height*o,"ryusui");h.setOrigin(.5,r/2),this.sprites.push(h),this.add(this.sprites)}this.width=i.source[0].width,this.height=i.source[0].height*r,this.setDepth(2),this.scene.add.existing(this),this.scene.physics.add.existing(this),this.scene.physics.add.collider(this.scene.food_group,this,this.onColide),this.scene.physics.add.collider(this.scene.unko_group,this,this.onColide),this.clean()}clean(){this.scene.save_data.data.unko=[],this.scene.save();const e={x:-8,y:this.y};this.toiletTween=this.scene.tweens.add({targets:this,props:{x:{value:e.x,duration:1500}},ease:"Sine.easeIn",callbackScope:this,onComplete:()=>{this.destroy()}})}}class Ui extends Phaser.Scene{constructor(e){super("UIScene");a(this,"game");a(this,"em");a(this,"tm");a(this,"gohan_btn");a(this,"toilet_btn");a(this,"reset_btn");a(this,"foods_menu");a(this,"alive_buttons");Phaser.Scene.call(this,{key:"UIScene",active:!0}),this.game=e,this.em=new EvolutionManage(e),this.tm=new TimeManage(e)}preload(){this.load.spritesheet("btn","assets/img/ui/btn_gray2.png",{frameWidth:30,frameHeight:18}),this.load.spritesheet("btn_frame","assets/img/ui/btn_gray_frame.png",{frameWidth:30,frameHeight:18}),this.load.image("sound_on","assets/img/ui/sound_on.png"),this.load.image("sound_off","assets/img/ui/sound_off.png")}create(){this.game=this.scene.get("GameScene"),this.gohan_btn=new Button(this,32,300,{color:16711782,text:"\u3054\u306F\u3093",onClick:()=>{this.foods_menu.setVisible(!this.foods_menu.visible)}}),this.gohan_btn.setVisible(!1),this.toilet_btn=new Button(this,160,300,{color:39423,text:"\u30C8\u30A4\u30EC",onClick:()=>{new Toilet(this.game,this.game.sceneW+8,this.game.sceneH-8*10)}}),this.toilet_btn.setVisible(!1),this.alive_buttons=new phaser.exports.GameObjects.Group(this,[this.gohan_btn,this.toilet_btn]),this.reset_btn=new Button(this,96,300,{text:"\u30EA\u30BB\u30C3\u30C8",onClick:()=>{var e;this.game.save_data=JSON.parse(JSON.stringify(save_data_template)),this.game.save_data.data.time.start=Date.now(),this.game.save_data.data.player.stage=0,(e=this.game.player)==null||e.changeChara("tamago")}}),this.reset_btn.setVisible(!1),this.foods_menu=new FoodsMenu(this,this.game,0,0,2)}update(e,t){var s,i,r;((s=this.game.player)==null?void 0:s.isEvolution)||((i=this.game.player)==null?void 0:i.name)=="tamago"?this.scene.setVisible(!1):this.scene.setVisible(!0),((r=this.game.player)==null?void 0:r.name)=="haka"?(this.alive_buttons.setVisible(!1),this.reset_btn.setVisible(!0)):(this.alive_buttons.setVisible(!0),this.reset_btn.setVisible(!1))}}class Sound extends Phaser.GameObjects.Container{constructor(e,t,s){super(e,t,s);a(this,"scene");a(this,"sprite");a(this,"isMute");a(this,"onClick",()=>{this.isMute=!this.isMute;const e=this.isMute?"sound_off":"sound_on";this.sprite.setTexture(e),this.scene.events.emit("changeMute")});this.scene=e,this.sprite=e.add.sprite(0,0,"sound_off"),this.width=this.sprite.width,this.height=this.sprite.height,this.setSize(this.width,this.height).setInteractive(),this.isMute=!0,this.add([this.sprite]),this.scene.add.existing(this),this.on("pointerup",i=>{this.onClick()})}}class Sounds extends Phaser.Scene{constructor(e,t){super("Sounds");a(this,"game");a(this,"ui");a(this,"bgm");a(this,"isMute");a(this,"SoundButton");Phaser.Scene.call(this,{key:"Sounds",active:!0}),this.isMute=!0,this.game=e,this.ui=t}preload(){this.load.audio("bgm",["assets/sound/bgm.mp3"])}create(){this.SoundButton=new Sound(this,this.scale.width-20,20),this.events.on("changeMute",()=>{this.isMute=!this.isMute,this.bgm.setMute(this.isMute)}),this.bgm=this.sound.add("bgm"),this.bgm.setMute(this.isMute),this.bgm.play({loop:!0,volume:.2})}}const game=new Game,ui=new Ui(game),sounds=new Sounds(game,ui);new Phaser.Game(Object.assign(config,{scene:[game,sounds,ui]}));
